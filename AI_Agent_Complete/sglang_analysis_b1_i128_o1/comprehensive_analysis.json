{
  "timestamp": "2025-12-17T03:03:17.661245",
  "nsys_overview": {
    "kernel_analysis": {
      "total_kernels": 13,
      "total_kernel_time": 0.222,
      "avg_kernel_time": 0.017076923076923076
    },
    "layer_kernels_rows": [
      {
        "name": "void flashinfer::norm::RMSNormKernel<(unsigned int)8, __half>(T2 *, T2 *, T2 *, unsigned int, unsigned int, unsigned int, float, float)",
        "dur_ms": 0.003
      },
      {
        "name": "nvjet_hsh_96x128_64x7_2x1_v_bz_TNN",
        "dur_ms": 0.046
      },
      {
        "name": "void flashinfer::BatchQKApplyRotaryPosIdsCosSinCacheHeadParallelismKernel<(bool)0, (unsigned int)128, (unsigned int)8, (unsigned int)16, __half, long>(T5 *, T5 *, T5 *, T5 *, float *, T6 *, unsigned int, unsigned int, unsigned int, unsigned int, unsigned long, unsigned long, unsigned long, unsigned long, unsigned long, unsigned long, unsigned long, unsigned long)",
        "dur_ms": 0.004
      },
      {
        "name": "void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void at::native::index_put_kernel_impl<at::native::OpaqueType<(int)2>>(at::TensorIterator &, c10::ArrayRef<long>, c10::ArrayRef<long>)::[lambda(char *, const char *, long) (instance 1)]>(at::TensorIteratorBase &, c10::ArrayRef<long>, c10::ArrayRef<long>, const T1 &, bool)::[lambda(int) (instance 1)]>(long, T3)",
        "dur_ms": 0.006
      },
      {
        "name": "void at::native::index_elementwise_kernel<(int)128, (int)4, void at::native::gpu_index_kernel<void at::native::index_put_kernel_impl<at::native::OpaqueType<(int)2>>(at::TensorIterator &, c10::ArrayRef<long>, c10::ArrayRef<long>)::[lambda(char *, const char *, long) (instance 1)]>(at::TensorIteratorBase &, c10::ArrayRef<long>, c10::ArrayRef<long>, const T1 &, bool)::[lambda(int) (instance 1)]>(long, T3)",
        "dur_ms": 0.006
      },
      {
        "name": "void at::native::elementwise_kernel<(int)128, (int)4, void at::native::gpu_kernel_impl_nocast<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase &)::[lambda() (instance 3)]::operator ()() const::[lambda() (instance 10)]::operator ()() const::[lambda(c10::Half) (instance 1)]>(at::TensorIteratorBase &, const T1 &)::[lambda(int) (instance 1)]>(int, T3)",
        "dur_ms": 0.004
      },
      {
        "name": "flash::prepare_varlen_num_blocks_kernel(int, int, int, const int *, const int *, const int *, const int *, const int *, const int *, int, int, int, int, int, cutlass::FastDivmod, cutlass::FastDivmod, int *, int *, bool)",
        "dur_ms": 0.003
      },
      {
        "name": "void cutlass::device_kernel<flash::enable_sm90_or_later<flash::FlashAttnFwdSm90<flash::CollectiveMainloopFwdSm90<(int)2, cute::tuple<cute::C<(int)1>, cute::C<(int)1>, cute::C<(int)1>>, cute::tuple<cute::C<(int)128>, cute::C<(int)128>, cute::C<(int)128>>, (int)128, cutlass::half_t, float, cutlass::arch::Sm90, (bool)1, (bool)0, (bool)0, (bool)1, (bool)1, (bool)0, (bool)0, (bool)1, (bool)1, (bool)1, (bool)0, (bool)0, cutlass::bfloat16_t>, flash::CollectiveEpilogueFwd<cute::tuple<cute::C<(int)128>, cute::C<(int)128>, cute::C<(int)128>>, cute::tuple<cute::C<(int)1>, cute::C<(int)1>, cute::C<(int)1>>, cutlass::half_t, cutlass::arch::Sm90, (int)256, (bool)1, (bool)1, (bool)0, (bool)0>, flash::VarlenDynamicPersistentTileScheduler<(int)128, (int)256, (int)128, (bool)0, (bool)1, (bool)1>>>>(T1::Params)",
        "dur_ms": 0.011
      },
      {
        "name": "nvjet_hsh_64x64_64x13_1x2_h_bz_TNT",
        "dur_ms": 0.017
      },
      {
        "name": "void flashinfer::norm::FusedAddRMSNormKernel<(unsigned int)8, __half>(T2 *, T2 *, T2 *, unsigned int, unsigned int, unsigned int, float, float)",
        "dur_ms": 0.004
      },
      {
        "name": "nvjet_hsh_168x128_64x5_2x1_v_bz_TNN",
        "dur_ms": 0.074
      },
      {
        "name": "void flashinfer::activation::act_and_mul_kernel<__half, &silu<float>>(T1 *, const T1 *, int)",
        "dur_ms": 0.004
      },
      {
        "name": "nvjet_hsh_64x64_64x13_1x2_h_bz_TNT",
        "dur_ms": 0.04
      }
    ],
    "layer_kernels_source": "/workspace/Agent/AI_Agent_Complete/sglang_analysis_b1_i128_o1/layer_kernels_run2_hot.json"
  },
  "hot_kernels_count": 13,
  "ncu_detailed_analysis": {
    "ncu_kernel_0_void_flashinfer__norm__RMSNormKernel__unsigned_int": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 3,
      "gpu_utilization": {
        "average_sm_efficiency": 23.54,
        "max_sm_efficiency": 23.54,
        "min_sm_efficiency": 23.54,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 204.89,
          "max_bandwidth": 204.89,
          "min_bandwidth": 204.89
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 67.67,
          "kernels_low_l2_hit_rate": 0
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 25.0,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "compute",
          "severity": "medium",
          "description": "SM效率过低 (23.5%)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (67.7%)"
        },
        {
          "type": "latency",
          "severity": "medium",
          "description": "占用率效率低 (24.3%)"
        }
      ]
    },
    "ncu_kernel_1_nvjet_hsh_96x128_64x7_2x1_v_bz_TNN": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 2,
      "gpu_utilization": {
        "average_sm_efficiency": 50.505,
        "max_sm_efficiency": 50.505,
        "min_sm_efficiency": 50.505,
        "kernels_below_50_percent": 0,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 2.565,
          "max_bandwidth": 2.565,
          "min_bandwidth": 2.565
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 31.96,
          "kernels_low_l2_hit_rate": 1
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 0.0,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "memory",
          "severity": "medium",
          "description": "内存带宽利用率低 (2.6 GB/s)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (32.0%)"
        }
      ]
    },
    "ncu_kernel_2_void_flashinfer__BatchQKApplyRotaryPosIdsCosSinCac": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 3,
      "gpu_utilization": {
        "average_sm_efficiency": 25.59,
        "max_sm_efficiency": 25.59,
        "min_sm_efficiency": 25.59,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 387.20000000000005,
          "max_bandwidth": 387.20000000000005,
          "min_bandwidth": 387.20000000000005
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 60.745000000000005,
          "kernels_low_l2_hit_rate": 0
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 71.38,
          "kernels_low_l1_hit_rate": 0
        }
      },
      "bottleneck_summary": [
        {
          "type": "compute",
          "severity": "medium",
          "description": "SM效率过低 (25.6%)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (60.7%)"
        },
        {
          "type": "latency",
          "severity": "medium",
          "description": "占用率效率低 (58.5%)"
        }
      ]
    },
    "ncu_kernel_3_void_at__native__index_elementwise_kernel__int_128": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 2,
      "gpu_utilization": {
        "average_sm_efficiency": 38.0325,
        "max_sm_efficiency": 38.0325,
        "min_sm_efficiency": 38.0325,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 141.28249999999997,
          "max_bandwidth": 141.28249999999997,
          "min_bandwidth": 141.28249999999997
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 67.11250000000001,
          "kernels_low_l2_hit_rate": 0
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 36.3025,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (67.1%)"
        },
        {
          "type": "latency",
          "severity": "medium",
          "description": "占用率效率低 (60.5%)"
        }
      ]
    },
    "ncu_kernel_4_void_at__native__index_elementwise_kernel__int_128": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 2,
      "gpu_utilization": {
        "average_sm_efficiency": 38.0125,
        "max_sm_efficiency": 38.0125,
        "min_sm_efficiency": 38.0125,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 139.6125,
          "max_bandwidth": 139.6125,
          "min_bandwidth": 139.6125
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 67.03,
          "kernels_low_l2_hit_rate": 0
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 36.3425,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (67.0%)"
        },
        {
          "type": "latency",
          "severity": "medium",
          "description": "占用率效率低 (60.2%)"
        }
      ]
    },
    "ncu_kernel_5_void_at__native__elementwise_kernel__int_128___int": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 3,
      "gpu_utilization": {
        "average_sm_efficiency": 24.275,
        "max_sm_efficiency": 24.275,
        "min_sm_efficiency": 24.275,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 173.51999999999998,
          "max_bandwidth": 173.51999999999998,
          "min_bandwidth": 173.51999999999998
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 66.27000000000001,
          "kernels_low_l2_hit_rate": 0
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 22.005,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "compute",
          "severity": "medium",
          "description": "SM效率过低 (24.3%)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (66.3%)"
        },
        {
          "type": "latency",
          "severity": "medium",
          "description": "占用率效率低 (43.6%)"
        }
      ]
    },
    "ncu_kernel_6_flash__prepare_varlen_num_blocks_kernel_int__int__": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 3,
      "gpu_utilization": {
        "average_sm_efficiency": 21.82,
        "max_sm_efficiency": 21.82,
        "min_sm_efficiency": 21.82,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 1.195,
          "max_bandwidth": 1.195,
          "min_bandwidth": 1.195
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 100.355,
          "kernels_low_l2_hit_rate": 0
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 25.0,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "compute",
          "severity": "medium",
          "description": "SM效率过低 (21.8%)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "内存带宽利用率低 (1.2 GB/s)"
        },
        {
          "type": "latency",
          "severity": "medium",
          "description": "占用率效率低 (46.2%)"
        }
      ]
    },
    "ncu_kernel_7_void_cutlass__device_kernel_flash__enable_sm90_or_": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 2,
      "gpu_utilization": {
        "average_sm_efficiency": 15.190000000000001,
        "max_sm_efficiency": 15.190000000000001,
        "min_sm_efficiency": 15.190000000000001,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 232.24,
          "max_bandwidth": 232.24,
          "min_bandwidth": 232.24
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 42.745,
          "kernels_low_l2_hit_rate": 1
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 2.0999999999999996,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "compute",
          "severity": "medium",
          "description": "SM效率过低 (15.2%)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (42.7%)"
        }
      ]
    },
    "ncu_kernel_8_nvjet_hsh_64x64_64x13_1x2_h_bz_TNT": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 2,
      "gpu_utilization": {
        "average_sm_efficiency": 42.9625,
        "max_sm_efficiency": 42.9625,
        "min_sm_efficiency": 42.9625,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 2.265,
          "max_bandwidth": 2.265,
          "min_bandwidth": 2.265
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 39.1375,
          "kernels_low_l2_hit_rate": 1
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 0.0,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "memory",
          "severity": "medium",
          "description": "内存带宽利用率低 (2.3 GB/s)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (39.1%)"
        }
      ]
    },
    "ncu_kernel_9_void_flashinfer__norm__FusedAddRMSNormKernel__unsi": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 3,
      "gpu_utilization": {
        "average_sm_efficiency": 20.52,
        "max_sm_efficiency": 20.52,
        "min_sm_efficiency": 20.52,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 333.86,
          "max_bandwidth": 333.86,
          "min_bandwidth": 333.86
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 61.377500000000005,
          "kernels_low_l2_hit_rate": 0
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 40.0,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "compute",
          "severity": "medium",
          "description": "SM效率过低 (20.5%)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (61.4%)"
        },
        {
          "type": "latency",
          "severity": "medium",
          "description": "占用率效率低 (24.3%)"
        }
      ]
    },
    "ncu_kernel_10_nvjet_hsh_168x128_64x5_2x1_v_bz_TNN": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 2,
      "gpu_utilization": {
        "average_sm_efficiency": 49.91,
        "max_sm_efficiency": 49.91,
        "min_sm_efficiency": 49.91,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 2.56,
          "max_bandwidth": 2.56,
          "min_bandwidth": 2.56
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 22.57,
          "kernels_low_l2_hit_rate": 1
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 0.0,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "memory",
          "severity": "medium",
          "description": "内存带宽利用率低 (2.6 GB/s)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (22.6%)"
        }
      ]
    },
    "ncu_kernel_11_void_flashinfer__activation__act_and_mul_kernel___": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 2,
      "gpu_utilization": {
        "average_sm_efficiency": 34.644999999999996,
        "max_sm_efficiency": 34.644999999999996,
        "min_sm_efficiency": 34.644999999999996,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 814.815,
          "max_bandwidth": 814.815,
          "min_bandwidth": 814.815
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 44.165,
          "kernels_low_l2_hit_rate": 1
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 21.64,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (44.2%)"
        },
        {
          "type": "latency",
          "severity": "medium",
          "description": "占用率效率低 (43.8%)"
        }
      ]
    },
    "ncu_kernel_12_nvjet_hsh_64x64_64x13_1x2_h_bz_TNT": {
      "kernels_analyzed": 1,
      "bottlenecks_found": 2,
      "gpu_utilization": {
        "average_sm_efficiency": 43.1975,
        "max_sm_efficiency": 43.1975,
        "min_sm_efficiency": 43.1975,
        "kernels_below_50_percent": 1,
        "total_kernels": 1
      },
      "memory_analysis": {
        "bandwidth_stats": {
          "average_bandwidth": 2.2475,
          "max_bandwidth": 2.2475,
          "min_bandwidth": 2.2475
        },
        "l2_cache_stats": {
          "average_l2_hit_rate": 37.662499999999994,
          "kernels_low_l2_hit_rate": 1
        },
        "l1_cache_stats": {
          "average_l1_hit_rate": 0.0,
          "kernels_low_l1_hit_rate": 1
        }
      },
      "bottleneck_summary": [
        {
          "type": "memory",
          "severity": "medium",
          "description": "内存带宽利用率低 (2.2 GB/s)"
        },
        {
          "type": "memory",
          "severity": "medium",
          "description": "L2缓存命中率低 (37.7%)"
        }
      ]
    }
  },
  "ncu_focus_analysis": {}
}